---
class: post-blog post-detail
type: Blog
$title: "New functionality to help manage user choice in AMP pages"
id: new-functionality-to-help-manage-user-choice-in-amp-pages
author: Vamsee Jasti
role:  Product Manager, AMP Project
origin: "https://amphtml.wordpress.com/2018/05/04/new-functionality-to-help-manage-user-choice-in-amp-pages/amp/"
excerpt: "Over the past few weeks, we launched tools to help publishers collect user consent. Today, we’d like to give you an update on some new functionality  that may make it easier for publishers to collect consent on AMP pages. Ad Network integrations with the &#60;amp-consent&#62; component The DoubleClick and AdSense implementations of &#60;amp-ad&#62; now support [&#8230;]"
avatar: https://1.gravatar.com/avatar/42ecb1ea497ca9d0ffe1e406cae70e27?s=96&d=identicon&r=G
date_data: 2018-05-04T16:50:15-04:00
$date: May 4, 2018
$parent: /content/latest/list-blog.html
$path: /latest/blog/{base}/
$localization:
  path: /{locale}/latest/blog/{base}/
components:
  - social-share
inlineCSS: .amp-wp-inline-329fdb7771c10d07df9eb73273c95a60{font-weight:400;}.amp-wp-inline-5a9880162246cbba0e891a128bbe4298{padding-left:180px;}
---

<div class="amp-wp-article-content">

		<p><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">Over the past few weeks, we </span><a href="https://amphtml.wordpress.com/2018/04/18/new-tools-for-building-user-controls-in-amp-pages/"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">launched</span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60"> tools to help publishers collect user consent. Today, we’d like to give you an update on some new functionality  that may make it easier for publishers to collect consent on AMP pages.</span></p><h3><b>Ad Network integrations with the &lt;amp-consent&gt; component </b></h3><p><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">The DoubleClick and AdSense implementations of &lt;amp-ad&gt; now support &lt;amp-consent&gt;, including non-personalized ad serving. </span><a href="https://support.google.com/dfp_premium/answer/7678538#amp-pages"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">See detailed documentation</span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60"> about when and how to serve non-personalized ads from DoubleClick and AdSense and availability </span><a href="https://github.com/ampproject/amphtml/blob/master/extensions/amp-consent/amp-consent.md#integrations-and-availablity"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">here</span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">. </span></p><p><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">Separately, if you are an ads or analytics vendor, you can learn more about how you can integrate with &lt;amp-consent&gt; </span><a href="https://github.com/ampproject/amphtml/blob/master/extensions/amp-consent/customizing-extension-behaviors-on-consent.md"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">here</span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">. </span></p><h3><b>&lt;amp-ima-video&gt; support for &lt;amp-consent&gt;</b></h3><p><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">Publishers can now collect consent when using the &lt;amp-ima-video&gt; component. See availability date </span><a href="https://github.com/ampproject/amphtml/blob/master/extensions/amp-consent/amp-consent.md#integrations-and-availablity"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">here</span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">. </span></p><h3><b>Using &lt;amp-geo&gt; for geolocation-based configuration of &lt;amp-consent&gt;</b></h3><p><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">AMP provides a way to configure &lt;amp-consent&gt; with a remote call by using the </span><a href="https://www.ampproject.org/id/docs/reference/components/amp-consent#checkconsenthref"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">checkConsentHref</span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60"> field. If you wished to incorporate geolocation-based logic for &lt;amp-consent&gt;, you  would need to resolve geolocation on the server-side, and customize the </span><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">checkConsentHref </span><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">response accordingly. Until now, it was not possible to have geolocation-based logic without a remote server setup.</span></p><p><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">The </span><a href="https://www.ampproject.org/docs/reference/components/amp-geo"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">&lt;amp-geo&gt; </span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">component recently launched to enable content variation based on users’ approximate location, at the level of an ISO Country Code. Now, you can use this functionality in combination with &lt;amp-consent&gt;, which also means you could skip implementing checkConsentHref, if your configuration needs do not extend beyond geolocation. Checkout the </span><a href="https://www.ampproject.org/docs/reference/components/amp-consent#consent-configuration"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">ampbyexample.com </span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60"> &lt;amp-geo&gt; sample or the </span><a href="https://www.ampproject.org/docs/reference/components/amp-consent#consent-configuration"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">&lt;amp-consent&gt;</span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60"> documentation.  </span></p><h3><b>&lt;amp-consent&gt; support in AMP stories</b></h3><p><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">Coming soon, &lt;amp-consent&gt; will be available to use with &lt;amp-story&gt;.  For the &lt;amp-story&gt; use case only, most of the UI will be pre-configured, though there will be publisher-specifiable choices for the look and feel in addition to full control over the text content. In addition, all &lt;amp-consent&gt; UIs in AMP stories will be blocking (i.e., the consent UI will not have an optional close button). See availability date </span><a href="https://github.com/ampproject/amphtml/blob/master/extensions/amp-consent/amp-consent.md#integrations-and-availablity"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">here</span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">.</span></p><p class="amp-wp-inline-5a9880162246cbba0e891a128bbe4298"><amp-img class="alignnone  wp-image-2028 amp-wp-enforced-sizes" src="https://amphtml.files.wordpress.com/2018/05/amp_consent.png?w=221&amp;h=383" alt="amp_consent" width="221" height="383" srcset="https://amphtml.files.wordpress.com/2018/05/amp_consent.png?w=221&amp;h=383 221w, https://amphtml.files.wordpress.com/2018/05/amp_consent.png?w=87&amp;h=150 87w, https://amphtml.files.wordpress.com/2018/05/amp_consent.png?w=173&amp;h=300 173w, https://amphtml.files.wordpress.com/2018/05/amp_consent.png 306w" sizes="(min-width: 221px) 221px, 100vw"></amp-img></p><h3><b>New features in &lt;amp-consent&gt; </b></h3><p><b>checkConsentHref support for key-value pairs : </b><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">This feature allows the checkConsentHref endpoint to respond with key-value pairs that can be propagated to and consumed by the ad network implementation. This is useful for publishers who want to communicate additional configuration information to ad networks to serve appropriate ads. This information is available to AMP components that wait on &lt;amp-consent&gt; to resolve. More details </span><a href="https://github.com/ampproject/amphtml/blob/master/extensions/amp-consent/amp-consent.md#response"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">here</span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">.</span></p><p><b>Timeouts in &lt;amp-consent&gt; : </b><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">With this feature, publishers could unblock components waiting for consent after a certain timeout. The feature also allows publishers to configure consent state that would be obtained by the AMP components blocked on the consent. More details </span><a href="https://github.com/ampproject/amphtml/blob/master/extensions/amp-consent/amp-consent.md#timeout-optional"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">here</span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">.</span></p><h3><b>Availability</b></h3><p><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">All this functionality is launching at different times in May, 18. Below is a summary of availability and you can go </span><a href="https://github.com/ampproject/amphtml/blob/master/extensions/amp-consent/amp-consent.md#integrations-and-availablity"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">here</span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60"> for the latest updates.</span></p><table><tbody><tr><td><b>Functionality</b></td>
<td><strong>Prod Availability</strong></td>
<td><strong>Documentation</strong></td>
<td><strong>Ready For Testing?</strong></td>
</tr><tr><td><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">DoubleClick &amp; AdSense</span></td>
<td><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">05/10/18</span></td>
<td><a href="https://support.google.com/dfp_premium/answer/7678538#amp-pages"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">Link</span></a></td>
<td><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">Yes</span></td>
</tr><tr><td><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">AMP IMA Video Integration</span></td>
<td><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">05/15/18</span></td>
<td></td>
<td><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">No</span></td>
</tr><tr><td><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">AMP Geo</span></td>
<td><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">05/10/18</span></td>
<td><a href="https://ampbyexample.com/user_consent/geolocation-based_consent_flow/"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">Link</span></a></td>
<td><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">Yes</span></td>
</tr><tr><td><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">AMP Stories</span></td>
<td><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">05/15/18</span></td>
<td></td>
<td><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">No</span></td>
</tr></tbody></table><h3><b>What’s next?</b></h3><p><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">There are a number of features planned for &lt;amp-consent&gt; including supporting </span><a href="https://github.com/ampproject/amphtml/issues/14913"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">external consent flows</span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60"> and </span><a href="https://github.com/ampproject/amphtml/issues/13716#issuecomment-382474345"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">many others</span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">. If you have features in mind that haven’t been discussed yet, please add a comment to the master </span><a href="https://github.com/ampproject/amphtml/issues/13716#issue-301131800"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">issue</span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">. </span></p><p><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">Also, don’t forget to check out the amp-consent</span><a href="https://ampbyexample.com/#user_consent"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60"> usage examples on AMP By Example</span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">. </span></p><p><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">As always, thanks for your support. If you have any questions, let us know by opening an </span><a href="https://github.com/ampproject/amphtml/issues/new"><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">issue on GitHub</span></a><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">. </span></p><p><i><span class="amp-wp-inline-329fdb7771c10d07df9eb73273c95a60">Posted by Vamsee Jasti, Product Manager, AMP Project</span></i></p>	</div>

	

</div>

